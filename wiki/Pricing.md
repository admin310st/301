## 1. Обзор тарифных планов Cloudflare (с точки зрения клиента)

Cloudflare предлагает платные тарифы, но для цели управление доменами, редиректами, TDS платный тариф не обязателен. 
Клиент начинает и может оставаться на бесплатном тарифе, для этого 301 реализовывает логику через Workers. 
Применение платныех опций на Cloudflare клиента происходит по решению клиента.
301  — фокусируйтся на обходе лимитов через гибкие инструменты.

### Бесплатный тариф (Free Plan)
 **Доступно без оплаты**: Полноценный контроль для базовых нужд.
 **Ключевые функции**:
  - Управление DNS-зонами (A, CNAME, TXT и др. записи, включая поддомены 2–4 уровня).
  - Workers: До 100 000 запросов в день (~3 млн/мес) — достаточно для TDS и редиректов.
    - Гео, IP, User-Agent: Доступны в Workers для TDS-логики.
  - Redirect Rules: До 10 правил на зону (статические редиректы 301/302, без регулярок или подстановок).
  - Page Rules: До 3 правил на аккаунт (мало для массовых редиректов; можно использовать для кэширования или обхода Workers на статике).
    - Внимание! Это старый способ управлять поведением Cloudflare по URL. Сейчас всё это делается через современные, модульные Rules.
    - Redirect Rules — для редиректов, Cache Rules — для управления кэшем, Firewall Rules — для блокировок по IP, гео, User-Agent и т.д.
  - WAF-правила: до 5 кастомных правил на аккаунт — полезны для блокировки по User-Agent, путям или странам, чтобы снизить нагрузку на Workers.
  - API-доступ: Полный для автоматизации (зоны, Workers, DNS, KV, D1 — через Wrangler и REST API).
  - Universal SSL: Автоматически для всех доменов (включая поддомены).
 **Ограничения**: Нет динамических правил в Redirect Rules (пример: условные редиректы по гео). Лимит Workers — 100k/день (но легко обходить через оптимизацию).
 **Вывод для клиента**: Хватит для 95% сценариев. Платформа (301) реализует редиректы и TDS через Workers, чтобы обойти лимиты Page/Redirect Rules.

### Платные тарифы (Pro / Business / Enterprise)
- **Pro ($20/мес за домен)**:
  - Page Rules: До 20.
  - Workers: До 10 млн запросов/день.
  - Дополнительно: Кастомные SSL, приоритетная поддержка.
  - **Когда нужно?** Редко — только если >10 доменов и клиент настаивает на Page Rules. Не подходит для TDS с динамикой.
- **Business ($200/мес за аккаунт)**:
  - Page Rules: До 50.
  - Workers: До 100 млн запросов/день.
  - Bulk Redirects: Массовые статические редиректы через CSV.
  - Дополнительно: Logpush, Bot Fight Mode.
  - **Когда нужно?** Для очень высоких нагрузок или сложных редиректов. Избыточно для арбитража — TDS лучше на Workers.
- **Workers Paid (отдельная опция, $0.15 за 1 млн запросов)**:
  - Снимает лимит 100k/день без смены тарифа.
  - **Когда нужно?** Только при пиковой нагрузке (>100k посещений/день).
- **Enterprise**: Избыточен.
- **Вывод**: В документации: «Вам не нужен платный тариф — наша система работает на бесплатном Workers».  Вам не нужно создавать Workers, KV-пространства или базы данных — всё это управляется нами.  Просто добавьте домен и настройте правила через панель.

## 2. Расчет нагрузки на Workers (для бесплатного тарифа)

Workers — ключевой инструмент для TDS и редиректов. Каждый запрос (посещение домена) = 1 вызов Worker. Лимит Free: 100 000/день.

### Исходные данные для типичного клиента
- Количество доменов: 5–10 (активные + софт-блоки).
- Посещений на активный домен/день: 1 000–5 000.
- Посещений на неактивный (софт-блок): 500.
- Структура: Проекты (бренды) → Сайты (гео) → Зоны (домены с редиректами).

### Примеры расчетов
- **Минимум**: 5 доменов × 1 000 посещений = 5 000 запросов/день (мало нагрузки).
- **Средний**: 10 доменов × 3 000 (активные) + 10 × 500 (неактивные) = 35 000 запросов/день.
- **Максимум**: 20 доменов × 5 000 = 100 000 запросов/день (предел Free).
- **Пессимистичный (высокий трафик)**: 10 сайтов × 4 зоны × (8 000 актив + 1 000 неактив) = 120 000 запросов/день → превышение, подключить Workers Paid ($0.015/день за 100k).

### Вывод и рекомендации
- Хватит для 95% клиентов (до 80–90k посещений/день).
- В UI платформы: «Free поддерживает до 100 000 редиректов/день. При превышении — оплата по факту ($0.015 за 100k)».
- Оптимизация: Используйте один Worker для всех доменов, минимизируйте код (редирект сразу, без лишних вычислений).


